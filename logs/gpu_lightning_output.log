============================================
TRUE GPU VQE Run (lightning.gpu)
============================================
Start time: Mon Dec  1 18:05:17 EST 2025
Running on node: gpu01
Working directory: /home2/malarchr/project/QuantumVQE
Python: /home2/malarchr/.conda/envs/vqe-lightning-gpu/bin/python
============================================
GPU Info:
name, memory.total [MiB], driver_version
NVIDIA H100 PCIe, 81559 MiB, 535.129.03
NVIDIA H100 PCIe, 81559 MiB, 535.129.03
NVIDIA H100 PCIe, 81559 MiB, 535.129.03
NVIDIA H100 PCIe, 81559 MiB, 535.129.03
Mon Dec  1 18:05:17 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.129.03             Driver Version: 535.129.03   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA H100 PCIe               On  | 00000000:02:00.0 Off |                    0 |
| N/A   45C    P0              83W / 350W |    759MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA H100 PCIe               On  | 00000000:64:00.0 Off |                    0 |
| N/A   44C    P0              81W / 350W |   4027MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA H100 PCIe               On  | 00000000:82:00.0 Off |                    0 |
| N/A   44C    P0              79W / 350W |  20351MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA H100 PCIe               On  | 00000000:E3:00.0 Off |                    0 |
| N/A   35C    P0              48W / 350W |      7MiB / 81559MiB |      0%      Default |
|                                         |                      |             Disabled |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|    0   N/A  N/A     10681      C   .../xings/.local/bin/ollama/bin/ollama      746MiB |
|    1   N/A  N/A     16292      C   .../xings/.local/bin/ollama/bin/ollama     4014MiB |
|    2   N/A  N/A    630489      C   .../xings/.local/bin/ollama/bin/ollama    20338MiB |
+---------------------------------------------------------------------------------------+
============================================
JAX devices: [CpuDevice(id=0)]
Default backend: cpu
============================================
Running vqe_gpu.py (lightning.gpu)
============================================
SUCCESS: Using device: lightning.gpu (GPU-accelerated)
============================================================
GPU-ACCELERATED VQE (lightning.gpu + Optax)
============================================================
Device: lightning.gpu
This benchmark measures true GPU acceleration
Note: No Catalyst JIT - GPU accel from lightning.gpu device
============================================================
Bond lengths to scan: 100
Max VQE iterations per bond length: 300
============================================================
Step 001/100: Bond=0.350 A | Energy=-0.789269 Ha | Time=2.490s | Iterations=110
Step 002/100: Bond=0.377 A | Energy=-0.862236 Ha | Time=1.587s | Iterations=110
Step 003/100: Bond=0.404 A | Energy=-0.921251 Ha | Time=1.639s | Iterations=106
Step 004/100: Bond=0.430 A | Energy=-0.969093 Ha | Time=1.345s | Iterations=92
Step 005/100: Bond=0.457 A | Energy=-1.007880 Ha | Time=1.448s | Iterations=101
Step 006/100: Bond=0.484 A | Energy=-1.039254 Ha | Time=1.151s | Iterations=79
Step 007/100: Bond=0.511 A | Energy=-1.064502 Ha | Time=1.686s | Iterations=116
Step 008/100: Bond=0.537 A | Energy=-1.084651 Ha | Time=1.447s | Iterations=101
Step 009/100: Bond=0.564 A | Energy=-1.100533 Ha | Time=1.244s | Iterations=85
Step 010/100: Bond=0.591 A | Energy=-1.112825 Ha | Time=1.533s | Iterations=106
Step 011/100: Bond=0.618 A | Energy=-1.122090 Ha | Time=1.508s | Iterations=105
Step 012/100: Bond=0.644 A | Energy=-1.128796 Ha | Time=1.588s | Iterations=111
Step 013/100: Bond=0.671 A | Energy=-1.133338 Ha | Time=1.478s | Iterations=102
Step 014/100: Bond=0.698 A | Energy=-1.136051 Ha | Time=1.377s | Iterations=96
Step 015/100: Bond=0.725 A | Energy=-1.137217 Ha | Time=1.532s | Iterations=107
Step 016/100: Bond=0.752 A | Energy=-1.137078 Ha | Time=1.699s | Iterations=118
Step 017/100: Bond=0.778 A | Energy=-1.135839 Ha | Time=1.618s | Iterations=112
Step 018/100: Bond=0.805 A | Energy=-1.133673 Ha | Time=1.165s | Iterations=81
Step 019/100: Bond=0.832 A | Energy=-1.130733 Ha | Time=1.195s | Iterations=83
Step 020/100: Bond=0.859 A | Energy=-1.127147 Ha | Time=1.607s | Iterations=111
Step 021/100: Bond=0.885 A | Energy=-1.123016 Ha | Time=1.348s | Iterations=93
Step 022/100: Bond=0.912 A | Energy=-1.118435 Ha | Time=1.433s | Iterations=100
Step 023/100: Bond=0.939 A | Energy=-1.113486 Ha | Time=1.632s | Iterations=113
Step 024/100: Bond=0.966 A | Energy=-1.108235 Ha | Time=1.708s | Iterations=111
Step 025/100: Bond=0.992 A | Energy=-1.102741 Ha | Time=1.523s | Iterations=107
Step 026/100: Bond=1.019 A | Energy=-1.097055 Ha | Time=1.250s | Iterations=86
Step 027/100: Bond=1.046 A | Energy=-1.091232 Ha | Time=1.379s | Iterations=95
Step 028/100: Bond=1.073 A | Energy=-1.085302 Ha | Time=1.641s | Iterations=115
Step 029/100: Bond=1.099 A | Energy=-1.079298 Ha | Time=1.137s | Iterations=79
Step 030/100: Bond=1.126 A | Energy=-1.073278 Ha | Time=1.476s | Iterations=102
Step 031/100: Bond=1.153 A | Energy=-1.067247 Ha | Time=1.578s | Iterations=110
Step 032/100: Bond=1.180 A | Energy=-1.061242 Ha | Time=1.719s | Iterations=120
Step 033/100: Bond=1.207 A | Energy=-1.055286 Ha | Time=1.562s | Iterations=109
Step 034/100: Bond=1.233 A | Energy=-1.049401 Ha | Time=1.697s | Iterations=118
Step 035/100: Bond=1.260 A | Energy=-1.043610 Ha | Time=1.653s | Iterations=114
Step 036/100: Bond=1.287 A | Energy=-1.037927 Ha | Time=1.550s | Iterations=108
Step 037/100: Bond=1.314 A | Energy=-1.032371 Ha | Time=1.392s | Iterations=95
Step 038/100: Bond=1.340 A | Energy=-1.026958 Ha | Time=1.615s | Iterations=113
Step 039/100: Bond=1.367 A | Energy=-1.021697 Ha | Time=1.670s | Iterations=115
Step 040/100: Bond=1.394 A | Energy=-1.016599 Ha | Time=1.596s | Iterations=111
Step 041/100: Bond=1.421 A | Energy=-1.011665 Ha | Time=1.237s | Iterations=86
Step 042/100: Bond=1.447 A | Energy=-1.006925 Ha | Time=1.742s | Iterations=122
Step 043/100: Bond=1.474 A | Energy=-1.002362 Ha | Time=1.792s | Iterations=118
Step 044/100: Bond=1.501 A | Energy=-0.997988 Ha | Time=1.739s | Iterations=120
Step 045/100: Bond=1.528 A | Energy=-0.993803 Ha | Time=1.612s | Iterations=112
Step 046/100: Bond=1.555 A | Energy=-0.989808 Ha | Time=1.366s | Iterations=95
Step 047/100: Bond=1.581 A | Energy=-0.986012 Ha | Time=1.673s | Iterations=116
Step 048/100: Bond=1.608 A | Energy=-0.982403 Ha | Time=1.697s | Iterations=118
Step 049/100: Bond=1.635 A | Energy=-0.978983 Ha | Time=1.724s | Iterations=120
Step 050/100: Bond=1.662 A | Energy=-0.975746 Ha | Time=1.476s | Iterations=102
Step 051/100: Bond=1.688 A | Energy=-0.972696 Ha | Time=1.669s | Iterations=116
Step 052/100: Bond=1.715 A | Energy=-0.969821 Ha | Time=1.692s | Iterations=118
Step 053/100: Bond=1.742 A | Energy=-0.967118 Ha | Time=1.734s | Iterations=120
Step 054/100: Bond=1.769 A | Energy=-0.964581 Ha | Time=1.745s | Iterations=121
Step 055/100: Bond=1.795 A | Energy=-0.962204 Ha | Time=1.571s | Iterations=110
Step 056/100: Bond=1.822 A | Energy=-0.959983 Ha | Time=1.803s | Iterations=125
Step 057/100: Bond=1.849 A | Energy=-0.957908 Ha | Time=1.500s | Iterations=104
Step 058/100: Bond=1.876 A | Energy=-0.955975 Ha | Time=1.831s | Iterations=128
Step 059/100: Bond=1.903 A | Energy=-0.954175 Ha | Time=1.855s | Iterations=129
Step 060/100: Bond=1.929 A | Energy=-0.952492 Ha | Time=1.351s | Iterations=93
Step 061/100: Bond=1.956 A | Energy=-0.950948 Ha | Time=1.784s | Iterations=118
Step 062/100: Bond=1.983 A | Energy=-0.949508 Ha | Time=1.922s | Iterations=133
Step 063/100: Bond=2.010 A | Energy=-0.948175 Ha | Time=1.923s | Iterations=134
Step 064/100: Bond=2.036 A | Energy=-0.946934 Ha | Time=1.399s | Iterations=97
Step 065/100: Bond=2.063 A | Energy=-0.945801 Ha | Time=1.767s | Iterations=123
Step 066/100: Bond=2.090 A | Energy=-0.944750 Ha | Time=1.787s | Iterations=124
Step 067/100: Bond=2.117 A | Energy=-0.943779 Ha | Time=1.793s | Iterations=125
Step 068/100: Bond=2.143 A | Energy=-0.942886 Ha | Time=1.816s | Iterations=126
Step 069/100: Bond=2.170 A | Energy=-0.942063 Ha | Time=1.817s | Iterations=127
Step 070/100: Bond=2.197 A | Energy=-0.941300 Ha | Time=1.474s | Iterations=102
Step 071/100: Bond=2.224 A | Energy=-0.940610 Ha | Time=1.708s | Iterations=119
Step 072/100: Bond=2.251 A | Energy=-0.939970 Ha | Time=1.730s | Iterations=120
Step 073/100: Bond=2.277 A | Energy=-0.939383 Ha | Time=1.347s | Iterations=94
Step 074/100: Bond=2.304 A | Energy=-0.938844 Ha | Time=1.737s | Iterations=121
Step 075/100: Bond=2.331 A | Energy=-0.938350 Ha | Time=1.761s | Iterations=122
Step 076/100: Bond=2.358 A | Energy=-0.937896 Ha | Time=1.899s | Iterations=132
Step 077/100: Bond=2.384 A | Energy=-0.937481 Ha | Time=1.782s | Iterations=123
Step 078/100: Bond=2.411 A | Energy=-0.937101 Ha | Time=1.764s | Iterations=124
Step 079/100: Bond=2.438 A | Energy=-0.936753 Ha | Time=1.881s | Iterations=124
Step 080/100: Bond=2.465 A | Energy=-0.936434 Ha | Time=1.803s | Iterations=125
Step 081/100: Bond=2.491 A | Energy=-0.936143 Ha | Time=1.794s | Iterations=125
Step 082/100: Bond=2.518 A | Energy=-0.935877 Ha | Time=1.806s | Iterations=126
Step 083/100: Bond=2.545 A | Energy=-0.935633 Ha | Time=1.825s | Iterations=126
Step 084/100: Bond=2.572 A | Energy=-0.935410 Ha | Time=1.815s | Iterations=127
Step 085/100: Bond=2.598 A | Energy=-0.935207 Ha | Time=1.835s | Iterations=127
Step 086/100: Bond=2.625 A | Energy=-0.935021 Ha | Time=1.844s | Iterations=128
Step 087/100: Bond=2.652 A | Energy=-0.934852 Ha | Time=1.830s | Iterations=128
Step 088/100: Bond=2.679 A | Energy=-0.934697 Ha | Time=1.860s | Iterations=128
Step 089/100: Bond=2.706 A | Energy=-0.934556 Ha | Time=1.850s | Iterations=129
Step 090/100: Bond=2.732 A | Energy=-0.934428 Ha | Time=1.857s | Iterations=129
Step 091/100: Bond=2.759 A | Energy=-0.934310 Ha | Time=1.868s | Iterations=129
Step 092/100: Bond=2.786 A | Energy=-0.934201 Ha | Time=1.611s | Iterations=112
Step 093/100: Bond=2.813 A | Energy=-0.934106 Ha | Time=1.879s | Iterations=130
Step 094/100: Bond=2.839 A | Energy=-0.934018 Ha | Time=1.875s | Iterations=130
Step 095/100: Bond=2.866 A | Energy=-0.933937 Ha | Time=1.980s | Iterations=130
Step 096/100: Bond=2.893 A | Energy=-0.933861 Ha | Time=1.616s | Iterations=113
Step 097/100: Bond=2.920 A | Energy=-0.933797 Ha | Time=1.905s | Iterations=131
Step 098/100: Bond=2.946 A | Energy=-0.933737 Ha | Time=1.494s | Iterations=103
Step 099/100: Bond=2.973 A | Energy=-0.933682 Ha | Time=1.896s | Iterations=131
Step 100/100: Bond=3.000 A | Energy=-0.933632 Ha | Time=1.865s | Iterations=131

============================================================
PERFORMANCE METRICS - GPU (lightning.gpu + Optax)
============================================================
Total runtime: 164.91 seconds (2.75 minutes)
Avg time per bond length: 1.65 seconds
Total VQE iterations: 11345
Avg time per VQE iteration: 0.0145 seconds
============================================================
Plot saved as: vqe_results_gpu.png
============================================
End time: Mon Dec  1 18:08:28 EST 2025
============================================
